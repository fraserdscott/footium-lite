{"version":3,"file":"players.svelte-a06d43b6.js","sources":["../../../../../../common-lib/lib/esm/index.js","../../../../../src/lib/players/players.ts","../../../../../src/routes/players.svelte"],"sourcesContent":["import { hexConcat } from '@ethersproject/bytes';\nimport { keccak256 } from '@ethersproject/solidity';\nimport { BigNumber } from '@ethersproject/bignumber';\nexport function combine(address, name) {\n    const n = BigNumber.from(hexConcat([keccak256(['address', 'string'], [address, name]), keccak256(['string', 'address'], [name, address])]));\n    return n;\n}\n//# sourceMappingURL=index.js.map","import type { Readable } from 'svelte/store';\nimport { derived } from 'svelte/store';\nimport type { TransactionStore } from 'web3w';\nimport type { Invalidator, Subscriber, Unsubscriber } from 'web3w/dist/esm/utils/internals';\nimport { SUBGRAPH_ENDPOINT } from '$lib/blockchain/subgraph';\nimport { transactions } from '$lib/blockchain/wallet';\nimport type { QueryState, QueryStore } from '$lib/utils/stores/graphql';\nimport { HookedQueryStore } from '$lib/utils/stores/graphql';\nimport type { EndPoint } from '$lib/utils/graphql/endpoint';\nimport { chainTempo } from '$lib/blockchain/chainTempo';\n\ntype Players = {\n  id: string;\n  image: string;\n}[];\n\n// TODO web3w needs to export the type\ntype TransactionStatus = 'pending' | 'cancelled' | 'success' | 'failure' | 'mined';\ntype TransactionRecord = {\n  hash: string;\n  from: string;\n  submissionBlockTime: number;\n  acknowledged: boolean;\n  status: TransactionStatus;\n  nonce: number;\n  confirmations: number;\n  finalized: boolean;\n  lastAcknowledgment?: TransactionStatus;\n  to?: string;\n  gasLimit?: string;\n  gasPrice?: string;\n  data?: string;\n  value?: string;\n  contractName?: string;\n  method?: string;\n  args?: unknown[];\n  eventsABI?: unknown; // TODO\n  metadata?: unknown;\n  lastCheck?: number;\n  blockHash?: string;\n  blockNumber?: number;\n  events?: unknown[]; // TODO\n};\n\nclass MatchesStore implements QueryStore<Players> {\n  private queryStore: QueryStore<Players>;\n  private store: Readable<QueryState<Players>>;\n  constructor(endpoint: EndPoint, private transactions: TransactionStore) {\n    this.queryStore = new HookedQueryStore(\n      endpoint,\n      `\n    query {\n      players(first: 50) {\n        id\n        image\n      }\n    }`,\n      chainTempo,\n      { path: 'players' }\n    );\n    this.store = derived([this.queryStore, this.transactions], (values) => this.update(values)); // lambda ensure update is not bound and can be hot swapped on HMR\n  }\n\n  private update([$query]: [QueryState<Players>, TransactionRecord[]]): QueryState<Players> {\n    if (!$query.data) {\n      return $query;\n    } else {\n      let newData = $query.data;\n      return {\n        step: $query.step,\n        error: $query.error,\n        data: newData,\n      };\n    }\n  }\n\n  acknowledgeError() {\n    return this.queryStore.acknowledgeError();\n  }\n\n  subscribe(\n    run: Subscriber<QueryState<Players>>,\n    invalidate?: Invalidator<QueryState<Players>> | undefined\n  ): Unsubscriber {\n    return this.store.subscribe(run, invalidate);\n  }\n}\n\nexport const players = new MatchesStore(SUBGRAPH_ENDPOINT, transactions);","<script lang=\"ts\">\n  import WalletAccess from '$lib/blockchain/WalletAccess.svelte';\n  import NavButton from '$lib/components/styled/navigation/NavButton.svelte';\n  import {wallet} from '$lib/blockchain/wallet';\n  import {onMount} from 'svelte';\n  import {combine} from 'footium-lite-common';\n  import {players} from '$lib/players/players';\n\n  const standIn = `<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"180\" height=\"180\">\n<path fill=\"none\" stroke=\"#000\" stroke-width=\"16\" d=\"M9,89a81,81 0 1,1 0,2zm51-14c0-13 1-19 8-26c7-9 18-10 28-8c10,2 22,12 22,26c0,14-11,19-15,22c-3,3-5,6-5,9v22m0,12v16\"/>\n</svg>`;\n  onMount(() => {\n    console.log('mount players', {\n      combine: combine(wallet.address || '0x0000000000000000000000000000000000000000', 'hi').toString(),\n    });\n  });\n</script>\n\n<symbol id=\"icon-spinner6\" viewBox=\"0 0 32 32\">\n  <path\n    d=\"M12 4c0-2.209 1.791-4 4-4s4 1.791 4 4c0 2.209-1.791 4-4 4s-4-1.791-4-4zM24.719 16c0 0 0 0 0 0 0-1.812 1.469-3.281 3.281-3.281s3.281 1.469 3.281 3.281c0 0 0 0 0 0 0 1.812-1.469 3.281-3.281 3.281s-3.281-1.469-3.281-3.281zM21.513 24.485c0-1.641 1.331-2.972 2.972-2.972s2.972 1.331 2.972 2.972c0 1.641-1.331 2.972-2.972 2.972s-2.972-1.331-2.972-2.972zM13.308 28c0-1.487 1.205-2.692 2.692-2.692s2.692 1.205 2.692 2.692c0 1.487-1.205 2.692-2.692 2.692s-2.692-1.205-2.692-2.692zM5.077 24.485c0-1.346 1.092-2.438 2.438-2.438s2.438 1.092 2.438 2.438c0 1.346-1.092 2.438-2.438 2.438s-2.438-1.092-2.438-2.438zM1.792 16c0-1.22 0.989-2.208 2.208-2.208s2.208 0.989 2.208 2.208c0 1.22-0.989 2.208-2.208 2.208s-2.208-0.989-2.208-2.208zM5.515 7.515c0 0 0 0 0 0 0-1.105 0.895-2 2-2s2 0.895 2 2c0 0 0 0 0 0 0 1.105-0.895 2-2 2s-2-0.895-2-2zM28.108 7.515c0 2.001-1.622 3.623-3.623 3.623s-3.623-1.622-3.623-3.623c0-2.001 1.622-3.623 3.623-3.623s3.623 1.622 3.623 3.623z\"\n  />\n</symbol>\n<WalletAccess>\n  <div class=\"container\">\n    {#each [...Array(50).keys()] as item, index}\n      <div class=\"row\">\n        <div>\n          <svg width=\"200\">\n            {@html $players.data && $players.data.find((p) => parseInt(p.id) === index)\n              ? $players.data.find((p) => parseInt(p.id) === index).image\n              : standIn}\n          </svg>\n        </div>\n        <NavButton href={`/player/${index}`} class=\"m-4 w-max-content\">\n          Player {index} | {$players.data && $players.data.find((p) => parseInt(p.id) === index)\n            ? 'Minted'\n            : 'Not minted'}\n        </NavButton>\n      </div>\n    {/each}\n  </div>\n</WalletAccess>\n\n<style>\n  ::-webkit-input-placeholder {\n    /* Chrome/Opera/Safari */\n    color: gray;\n    opacity: 0.5;\n  }\n  ::-moz-placeholder {\n    /* Firefox 19+ */\n    color: gray;\n    opacity: 0.5;\n  }\n  :-ms-input-placeholder {\n    /* IE 10+ */\n    color: gray;\n    opacity: 0.5;\n  }\n  :-moz-placeholder {\n    /* Firefox 18- */\n    color: gray;\n    opacity: 0.5;\n  }\n  @media (prefers-color-scheme: dark) {\n    ::-webkit-input-placeholder {\n      /* Chrome/Opera/Safari */\n      color: pink;\n      opacity: 0.5;\n    }\n    ::-moz-placeholder {\n      /* Firefox 19+ */\n      color: pink;\n      opacity: 0.5;\n    }\n    :-ms-input-placeholder {\n      /* IE 10+ */\n      color: pink;\n      opacity: 0.5;\n    }\n    :-moz-placeholder {\n      /* Firefox 18- */\n      color: pink;\n      opacity: 0.5;\n    }\n  }\n</style>\n"],"names":[],"mappings":"4gBAGO,YAAiB,EAAS,EAAM,CAEnC,MADU,GAAU,KAAK,EAAU,CAAC,EAAU,CAAC,UAAW,UAAW,CAAC,EAAS,IAAQ,EAAU,CAAC,SAAU,WAAY,CAAC,EAAM,OCwCnI,QAAkD,CAGhD,YAAY,EAA4B,EAAgC,0BACjE,WAAa,GAAI,GACpB,EACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAOA,EACA,CAAE,KAAM,iBAEL,MAAQ,EAAQ,CAAC,KAAK,WAAY,KAAK,cAAe,AAAC,GAAW,KAAK,OAAO,IAG7E,OAAO,CAAC,GAA0E,IACnF,EAAO,KAEL,IACD,GAAU,EAAO,WACd,CACL,KAAM,EAAO,KACb,MAAO,EAAO,MACd,KAAM,cAND,GAWX,kBAAmB,OACV,MAAK,WAAW,mBAGzB,UACE,EACA,EACc,OACP,MAAK,MAAM,UAAU,EAAK,SAIxB,IAAU,GAAI,IAAa,EAAmB,4FCrD/B,MAAS,MAAQ,KAAS,KAAK,QAC7C,SACA,0EAHwD,eACpD,UAAM,0BAD8C,iBACpD,YAAM,oFAAI,MAAS,MAAQ,KAAS,KAAK,QAC7C,SACA,4FARK,MAAS,MAAQ,KAAS,KAAK,QAClC,KAAS,KAAK,QAAsC,MACpD,yIAGoB,2dAR9B,SACE,OACE,kFACS,MAAS,MAAQ,KAAS,KAAK,QAClC,KAAS,KAAK,QAAsC,MACpD,sMAND,MAAM,IAAI,6BAAnB,iSADJ,+EACa,MAAM,IAAI,0BAAnB,qHAAA,8DAAA,w+CAPN,SACE,kPAXM;;QAGN,cACE,QAAQ,IAAI,iBACV,QAAS,GAAQ,GAAO,SAAW,6CAA8C,MAAM,uBAgBrC,IAAM,SAAS,EAAE,MAAQ,KAC7C,IAAM,SAAS,EAAE,MAAQ,KAKI,IAAM,SAAS,EAAE,MAAQ"}